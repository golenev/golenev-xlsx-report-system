# Как загрузить автоматизированные тест-кейсы в репортер

Инструкция описывает единственный поток: отправить уже готовые результаты автоматизированных тестов в сервер репортера без запуска регресса. Требуется лишь собрать список тестов, соответствующий структуре моделей ниже, и выполнить один POST-запрос.

## Требуемая модель запроса
Отправляемый JSON должен соответствовать Kotlin-моделям, которые используются на сервере:

```kotlin
// Корневой объект запроса
// POST /api/tests/batch
// content-type: application/json

data class BatchRequest(
    val items: List<TestCaseItem>,
)

data class TestCaseItem(
    val testId: String,      // Уникальный идентификатор теста
    val category: String,    // Группа/модуль
    val shortTitle: String,  // Короткое имя теста
    val issueLink: String,   // Ссылка на задачу/требование
    val readyDate: String,   // LocalDate -> String. Отправлять НЕ нужно: сервер проставит дату готовности
                              // при первом добавлении и больше ее не перезапишет.
    val generalStatus: String, // Например: "Готово"
    val scenario: String,    // Человеко-читаемый сценарий
    val notes: String,       // Доп. комментарии. В запросе не требуется, можно заполнить в UI.
    val priority: String,    // Например: "Medium". Необязательно: по умолчанию будет medium, дальше правится через UI.
    val runStatus: String? = null // При прогоне вне регресса не учитывается; в регрессе выставляется автоматически.
)
```

Поля `readyDate`, `priority`, `notes` и `runStatus` передавать не требуется: дата готовности ставится сервером при первом
создании и больше не меняется, приоритет и примечания можно скорректировать вручную в UI, а статус прогона вне регресса не
используется.

## Правило для `AllureId`
Каждый автотест должен быть аннотирован `@AllureId()` с уникальным значением. Для параметризованного теста достаточно одной аннотации: при парсинге каждому кейсу автоматически добавится постфикс с индексом прогона. Например, `@AllureId(234)` превратится в `234-1`, `234-2` и т. д. для отдельных итераций.

## Пример запроса с двумя кейсами
Пример `curl`, отправляющий два тест-кейса одним батчем. Замените адрес сервера и значения полей при необходимости.

```bash
curl -X POST \
  "http://localhost:18080/api/tests/batch" \
  -H "Content-Type: application/json" \
  -d '{
    "items": [
      {
        "testId": "234-1",
        "category": "checkout",
        "shortTitle": "Успешная оплата картой",
        "issueLink": "https://tracker.example/ISSUE-123",
        "generalStatus": "Готово",
        "scenario": "1) открыть корзину; 2) оплатить картой; 3) убедиться, что статус оплаты success",
        "priority": "High"
      },
      {
        "testId": "234-2",
        "category": "checkout",
        "shortTitle": "Оплата картой с истекшим сроком",
        "issueLink": "https://tracker.example/ISSUE-124",
        "generalStatus": "Готово",
        "scenario": "1) открыть корзину; 2) оплатить истекшей картой; 3) получить ошибку об истечении срока",
        "priority": "Medium"
      }
    ]
  }'
```

Отправка такого запроса добавит оба тест-кейса на сервер. При успешном ответе (HTTP 200) они появятся в интерфейсе репортера.
